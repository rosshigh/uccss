<template>
    <div class="col-lg-12 col-sm-12">
        <div class='row'>
            <div class='col-lg-10 col-lg-offset-1 bottomMargin'>
                <table id="helpTicketTable" class="table table-striped table-hover">
                    <thead>
                        <tr>
                            <td colspan='8'>
                                <compose view="../../../../resources/elements/table-navigation-bar.html"></compose>
                            </td>
                        </tr>
                        <tr>
                            <td colspan='8'>
                                <span click.delegate="refresh()" class="smallMarginRight"><i class="fa fa-refresh" aria-hidden="true"></i></span>
                                <span class="pull-right" id="spinner" innerhtml.bind="spinnerHTML"></span>
                            </td>
                        </tr>
                  <tr>
                    <th></th>
                    <th class="hasinput">
                      <select change.delegate="dataTable.filterList($event)" class="form-control" id="helpTicketType">
                        <option value=""></option>
                        <option repeat.for="type of config.HELP_TICKET_TYPES"
                                value.bind="type.code">${type.description}</option>
                      </select>
                    </th>
                    <th>
                      <select change.delegate="dataTable.filterList($event)" class="form-control" id="owner.[0].personId" compare="obj">
                        <option value=""></option>
                        <option repeat.for="person of people.peopleArray | uccStaff"
                                value.bind="person._id">${person.fullName}</option>
                      </select>
                      <!--
                      <input change.delegate="dataTable.filterList($event, people.peopleArray)" compare="lookup" id="owner[0].personId-fullName" type="text" placeholder="Filter Owner" class="form-control">
                      -->
                    </th>
                    <th class="hasinput">
                      <select value.bind="selectedStatus" change.delegate="dataTable.filterList($event)" class="form-control" id="helpTicketStatus">
                        <option value=""></option>
                        <option repeat.for="status of config.HELP_TICKET_STATUSES"
                                value.bind="status.code">${status.description}</option>
                      </select>
                    </th>
                    <th class="hasinput">
                      <input change.delegate="dataTable.filterList($event)" id="createdDate" type="date" compare="after" placeholder="Filter Date" class="form-control datepicker" data-dateformat="yy/mm/dd">
                    </th>
                    <th>
                      <input input.delegate="dataTable.filterList($event, people.peopleArray)" id="personId-fullName" type="text" compare="lookup" class="form-control" />
                    </th>
                  </tr>
                  <tr>
                    <th>
                      Number <span click.trigger="dataTable.sortArray('helpTicketNo')"><i class="fa fa-sort"></i></span>
                    </th>
                    <th>
                      Type <span click.trigger="dataTable.sortArray('helpTicketType')"><i class="fa fa-sort"></i></span><br>
                    </th>
                     <th>
                      Owner <span click.trigger="dataTable.sortArray('owner[0].personId')"><i class="fa fa-sort"></i></span><br>
                    </th>
                    <th>
                      Status <span click.trigger="dataTable.sortArray('status')"><i class="fa fa-sort"></i></span><br>
                    </th>
                    <th>
                      Date Created <span click.trigger="dataTable.sortArray('createdDate')"><i class="fa fa-sort"></i></span>
                    </th>
                    <th>Customer</th>
                    <th>Email</th>
                     <th>Phone</th>
                  </tr>
                  </thead>
                  <tbody>
                  <tr repeat.for="helpTicket of dataTable.displayArray" click.delegate="selectHelpTicket($event, $index)">
                    <td data-title="referenceNo">${helpTicket.helpTicketNo}</td>
                    <td data-title="type">${helpTicket.helpTicketType | lookupDescription:config.HELP_TICKET_TYPES}</td>
                    <td data-title="owner">${helpTicket.owner[0].personId | person:people.peopleArray:'fullName'}
                    <td data-title="status">${helpTicket.helpTicketStatus | lookupDescription:config.HELP_TICKET_STATUSES}</td>
                    <td data-title="createdDate">${helpTicket.createdDate | dateFormat:config.DATE_FORMAT_TABLE:true}</td>
                    <td data-title="Customer">${helpTicket.personId | person:people.peopleArray:"fullName"}</td>
                    <td data-title="email">${helpTicket.personId | person:people.peopleArray:"email"}</td>
                    <td data-title="phone">${helpTicket.personId | person:people.peopleArray:"phone"}</td>
                  </tr>
                  </tbody>
                </table>
            </div>
            <div class="row" show.bind="helpTicketSelected">
              <compose view="./viewHTForm.html"></compose>
            </div>
          </div>
      </div>
    </div>
</template>